<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-C3LQ2SVGHJ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-C3LQ2SVGHJ');
  </script>



  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="yandex-verification" content="eef333a56a2c814a" />

  <title>
  Components - Pantrypoints
  </title>

  <link rel="icon" type="image/x-icon" href="/icons/pantry50.png">

  <meta name="description" content="We list down essential concepts in Phoenix Live View Components" /><link
    rel="stylesheet"
    href="//localhost:1313/css/styles.min.c800a5f0cf3bfc2d286b17ecf1e227546f66d41da8e25157f41327ba75ef4a84.css"
    integrity="sha256-yACl8M87/C0oaxfs8eInVG9m1B2o4lFX9BMnunXvSoQ="
  />
  
  <meta property="og:title" content="Components" />
<meta property="og:description" content="We list down essential concepts in Phoenix Live View Components" />
<meta property="og:type" content="article" />
<meta property="og:url" content="//localhost:1313/docs/tech/phoenix/liveview/components/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2022-04-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-04-22T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Components"/>
<meta name="twitter:description" content="We list down essential concepts in Phoenix Live View Components"/>

  <meta itemprop="name" content="Components">
<meta itemprop="description" content="We list down essential concepts in Phoenix Live View Components"><meta itemprop="datePublished" content="2022-04-22T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-04-22T00:00:00+00:00" />
<meta itemprop="wordCount" content="2013">
<meta itemprop="keywords" content="Phoenix," />

  
    <meta name="lang" content="en" />
  



<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2557957536703477" crossorigin="anonymous"></script>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" defer></script>


</head>
<body class="dark:bg-gray-900 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="//localhost:1313/" class="capitalize font-extrabold text-2xl">
    
      <div class="flex">
        <img src="/icons/pantry.png" alt="Pantrypoints" class="h-8 pr-2" /> 
        <small class="" style="text-transform: uppercase;">Pantrypoints</small>        
      </div>

    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-900">

    
      <li class="grid place-items-center"><a href="/trisactions">
        Trisactions
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/pantrypreneur/">
        Pantrypreneur
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/services">
        Services
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/docs/">
        Docs
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/news">
        News
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/faq">
        FAQ
        
      </a>
      </li>
    
      <li class="grid place-items-center"><a href="/company">
        About
        
      </a>
      </li>
    




    
    
    <li class="relative cursor-pointer">
      <span class="language-switcher flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
          stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="12" cy="12" r="9" />
          <line x1="3.6" y1="9" x2="20.4" y2="9" />
          <line x1="3.6" y1="15" x2="20.4" y2="15" />
          <path d="M11.5 3a17 17 0 0 0 0 18" />
          <path d="M12.5 3a17 17 0 0 1 0 18" />
        </svg>
        <a>Language</a>
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
          viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round"
          stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path d="M18 15l-6 -6l-6 6h12" transform="rotate(180 12 12)" />
        </svg>
      </span>
      <div
        class="language-dropdown absolute top-full mt-2 left-0 flex-col gap-2 bg-gray-100 dark:bg-gray-900 dark:text-white z-10 hidden">
        
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/zh" lang="zh">简体中</a>
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/de" lang="de">Deutsch</a>
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/fr" lang="fr">Français</a>
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/hi" lang="hi">Hindi</a>
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/jp" lang="jp">日本語</a>
        
        
        
        <a class="px-3 py-2 hover:bg-gray-200 dark:hover:bg-gray-700" href="/es" lang="es">Español</a>
        
        
      </div>
    </li>
    
    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
    <li class="grid place-items-center">
      <span class="toggle-dark-mode inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="12" cy="12" r="3" />
          <line x1="12" y1="5" x2="12" y2="5.01" />
          <line x1="17" y1="7" x2="17" y2="7.01" />
          <line x1="19" y1="12" x2="19" y2="12.01" />
          <line x1="17" y1="17" x2="17" y2="17.01" />
          <line x1="12" y1="19" x2="12" y2="19.01" />
          <line x1="7" y1="17" x2="7" y2="17.01" />
          <line x1="5" y1="12" x2="5" y2="12.01" />
          <line x1="7" y1="7" x2="7" y2="7.01" />
        </svg>
      </span>
    </li>
    
  </ul>
</header>
<main class="flex-1">





  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <div id="breadcrumbs" class="text-gray-500 dark:text-gray-200 mb-4" style="text-decoration: none;">
      <small>
            
              <a href="/"></a> /
            
              <a href="/docs/">Documentation</a> /
            
              <a href="/docs/tech/">Tech Docs</a> /
            
              <a href="/docs/tech/phoenix/">Phoenix Web Framework</a> /
            
              <a href="/docs/tech/phoenix/liveview/">LiveView</a> /
            <a href="/docs/tech/phoenix/liveview/components/">Components</a>
      </small>
    </div>

    


    <h1 class="text-2xl font-bold">Components</h1>

      
          

          
                    
          
    


    
    <h5 class="text-sm flex items-center flex-wrap">
                    
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
        April 22, 2022
      

      <svg xmlns="http://www.w3.org/2000/svg" class="ml-3 mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      10&nbsp;minutes
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      2013&nbsp;words
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 mb-2 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4"><ul>
        

        
        <li>
        <a href="#impl-true">@impl true</a>
        

        
        </li><li>
        <a href="#stateful-by-adding-id-and-pointing-to-the-component-with-myself">Stateful by adding <code>id</code> and pointing to the Component with <code>@myself</code></a>
        

        
        </li><li>
        <a href="#card-component-with-form">Card Component with Form</a>
        

        
        </li><li>
        <a href="#listing-of-cards">Listing of cards</a>
        

        
        </li></ul>
          <li>
        <a href="#liveview-as-the-source-self">LiveView as the Source: self()</a>
        

        
        </li><li>
        <a href="#livecomponent-as-the-source">LiveComponent as the Source</a>
        

        
        </li><li>
        <a href="#livecomponent-blocks">LiveComponent blocks</a>
        

        
        <ul>
            <li>
        <a href="#simplest-stateless-component-render1">Simplest Stateless Component: <code>render/1</code></a>
        

        
        </li><li>
        <a href="#passing-data-to-component-from-parent-liveview">Passing Data to Component from Parent LiveView</a>
        

        
        </li></ul>
      </li><li>
        <a href="#stateless-components">Stateless components</a>
        

        
        </li><li>
        <a href="#stateful-components-viaid">Stateful Components via<code>:id</code></a>
        

        
        <ul>
            <li>
        <a href="#component-events">Component Events</a>
        

        
        </li></ul>
      </li><li>
        <a href="#managing-state">Managing state</a>
        

        
        <ul>
            <li>
        <a href="#liveview-as-the-source-of-truth">LiveView as the source of truth</a>
        

        
        </li><li>
        <a href="#livecomponent-as-the-source-of-truth">LiveComponent as the source of truth</a>
        

        
        </li></ul>
      </li><li>
        <a href="#livecomponent-blocks-1">LiveComponent blocks</a>
        

        
        </li><li>
        <a href="#live-patches-and-live-redirects">Live patches and live redirects</a>
        

        
        </li><li>
        <a href="#cost-of-stateful-components">Cost of stateful components</a>
        

        
        <ul>
            <li>
        <a href="#keep-only-the-assigns-necessary-in-each-component">Keep only the assigns necessary in each component.</a>
        

        
        </li><li>
        <a href="#avoid-using-stateful-components-to-provide-abstract-dom-components">Avoid using stateful components to provide abstract DOM components</a>
        

        
        </li></ul>
      </li><li>
        <a href="#limitations">Limitations</a>
        

        
        </li><li>
        <a href="#form-bindings">Form Bindings</a>
        </li></ul>
  </details>
    
    <div class="dark:text-white text-black">
      <h3 id="impl-true">@impl true</h3>
<p>Tells LiveView to implement the callback</p>
<pre tabindex="0"><code>@impl true 
def render(assigns) do
  ~L&#34;&#34;&#34;
  whatever
  &#34;&#34;&#34;
</code></pre><h3 id="stateful-by-adding-id-and-pointing-to-the-component-with-myself">Stateful by adding <code>id</code> and pointing to the Component with <code>@myself</code></h3>
<p>Add <code>id</code> to the live_component to make it &lsquo;stateful&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">@socket</span>, <span style="color:#50fa7b">MessageComponent</span>, <span style="color:#f1fa8c">id</span>: <span style="color:#bd93f9">1</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Add <code>@myself</code> to the stateful form to make the Component handle the event</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>form phx<span style="color:#ff79c6">-</span>submit<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;send-message&#34;</span> phx<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;%= @myself %&gt;&#34;</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><h3 id="card-component-with-form">Card Component with Form</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">~H&#34;\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>form phx<span style="color:#ff79c6">-</span>submit<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;...&#34;</span> phx<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span>{<span style="color:#50fa7b">@myself</span>}<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>input name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;title&#34;</span><span style="color:#ff79c6">&gt;&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#50fa7b">@card</span><span style="color:#ff79c6">.</span>title %<span style="color:#ff79c6">&gt;&lt;/</span>input<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      ...
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>form<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">end</span>
</span></span></code></pre></div><h3 id="listing-of-cards">Listing of cards</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">for</span> card <span style="color:#ff79c6">&lt;-</span> <span style="color:#50fa7b">@cards</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">card</span>: card, <span style="color:#f1fa8c">id</span>: card<span style="color:#ff79c6">.</span>id, <span style="color:#f1fa8c">board_id</span>: <span style="color:#50fa7b">@id</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Form submission triggers <code>CardComponent.handle_event/3</code> which must update the card.</p>
<h2 id="liveview-as-the-source-self">LiveView as the Source: self()</h2>
<p>The component and the view run in the same process. So, sending an internal message from the LiveComponent to the parent LiveView is done by sending a message to <code>self()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>send self(), {<span style="color:#f1fa8c">:message_name</span>, %{content_of_message}}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> handle_event(<span style="color:#f1fa8c">&#34;update_title&#34;</span>, %{<span style="color:#f1fa8c">&#34;title&#34;</span> <span style="color:#ff79c6">=&gt;</span> title}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    send self(), {<span style="color:#f1fa8c">:updated_card</span>, %{socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>card <span style="color:#ff79c6">|</span> <span style="color:#f1fa8c">title</span>: title}}
</span></span><span style="display:flex;"><span>    {<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span></code></pre></div><p>LiveView then receives this event using <code>c:Phoenix.LiveView.handle_info/2</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">BoardView</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> handle_info({<span style="color:#f1fa8c">:updated_card</span>, card}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4"># update the list of cards in the socket</span>
</span></span><span style="display:flex;"><span>    {<span style="color:#f1fa8c">:noreply</span>, updated_socket}
</span></span></code></pre></div><p>The LiveView will send the updated card to the component.</p>
<p>Alternatively, the could be updated via broadcast by using <code>Phoenix.PubSub</code> to all users subscribed to it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> handle_event(<span style="color:#f1fa8c">&#34;update_title&#34;</span>, %{<span style="color:#f1fa8c">&#34;title&#34;</span> <span style="color:#ff79c6">=&gt;</span> title}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    message <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">:updated_card</span>, %{socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>card <span style="color:#ff79c6">|</span> <span style="color:#f1fa8c">title</span>: title}}
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">Phoenix.PubSub</span><span style="color:#ff79c6">.</span>broadcast(<span style="color:#50fa7b">MyApp.PubSub</span>, board_topic(socket), message)
</span></span><span style="display:flex;"><span>    {<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">defp</span> board_topic(socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;board:&#34;</span> <span style="color:#ff79c6">&lt;&gt;</span> socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>board_id
</span></span></code></pre></div><h2 id="livecomponent-as-the-source">LiveComponent as the Source</h2>
<p>In this case, LiveView must only fetch the card ids, then render each component only by passing an ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">for</span> card_id <span style="color:#ff79c6">&lt;-</span> <span style="color:#50fa7b">@card_ids</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">id</span>: card_id, <span style="color:#f1fa8c">board_id</span>: <span style="color:#50fa7b">@id</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Each CardComponent will load its own card making expensive N queries, where N is the number of cards. So we use the <code>c:preload/1</code> callback to make it efficient.</p>
<p>Once the card components are started, they can each manage their own card, without concern for the parent LiveView.</p>
<p>Components do not have a <code>c:Phoenix.LiveView.handle_info/2</code> callback. Therefore, if you want to track distributed changes on a card, you must have LiveView receive those events and redirect them to the appropriate card.</p>
<p>For example, if card updates are sent to the &ldquo;board:ID&rdquo; topic, and that the board LiveView is subscribed to the  said topic, one could do:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> handle_info({<span style="color:#f1fa8c">:updated_card</span>, card}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  send_update <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">id</span>: card<span style="color:#ff79c6">.</span>id, <span style="color:#f1fa8c">board_id</span>: socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>id
</span></span><span style="display:flex;"><span>  {<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span></code></pre></div><p>With <code>Phoenix.LiveView.send_update/3</code>, the <code>CardComponent</code> given by <code>id</code> will be invoked, triggering both preload and update callbacks, which will load the most up to date data from the database.</p>
<h2 id="livecomponent-blocks">LiveComponent blocks</h2>
<p>When <code>live_component/3</code> <code>(Phoenix.LiveView.Helpers.live_component/3)</code> is invoked, it is also possible to pass a <code>do/end</code> block:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">GridComponent</span>, <span style="color:#f1fa8c">entries</span>: <span style="color:#50fa7b">@entries</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>% entry <span style="color:#ff79c6">-&gt;</span> %<span style="color:#ff79c6">&gt;</span><span style="color:#50fa7b">New</span> <span style="color:#f1fa8c">entry</span>: <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> entry %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>The <code>do/end</code> will be available in an assign named <code>@inner_block</code>.</p>
<p>You can render its contents by calling <code>render_block</code> with the assign itself and a keyword list of assigns to inject into the rendered
content. For example, the grid component above could be implemented as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">GridComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">use</span> <span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">~H&#34;\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>div class<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;grid&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">for</span> entry <span style="color:#ff79c6">&lt;-</span> <span style="color:#50fa7b">@entries</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;</span>div class<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;column&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> render_block(<span style="color:#50fa7b">@inner_block</span>, entry) %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/</span>div<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p>Where the <code>entry</code> variable was injected into the <code>do/end</code> block.</p>
<p>Note the <code>@inner_block</code> assign is also passed to <code>c:update/2</code> along all other assigns. So if you have a custom <code>update/2</code> implementation, make sure to assign it to the socket like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> update(%{<span style="color:#f1fa8c">inner_block</span>: inner_block}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  {<span style="color:#f1fa8c">:ok</span>, assign(socket, <span style="color:#f1fa8c">inner_block</span>: inner_block)}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p>Components run inside the LiveView process, but may have their own state and event handling. They are either stateless or stateful.</p>
<p><strong>Setting</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span></code></pre></div><p><strong>Calling</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#50fa7b">Phoenix.LiveView.Helpers</span><span style="color:#ff79c6">.</span>live_component<span style="color:#ff79c6">/</span><span style="color:#bd93f9">3</span>` <span style="color:#ff79c6">in</span> a parent <span style="color:#50fa7b">LiveView</span>
</span></span></code></pre></div><h3 id="simplest-stateless-component-render1">Simplest Stateless Component: <code>render/1</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">HeroComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">use</span> <span style="color:#50fa7b">MyAppWeb</span>, <span style="color:#f1fa8c">:live_component</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;div&gt;&lt;%= @content %&gt;&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><h3 id="passing-data-to-component-from-parent-liveview">Passing Data to Component from Parent LiveView</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">HeroComponent</span>, <span style="color:#f1fa8c">content</span>: <span style="color:#50fa7b">@content</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><h2 id="stateless-components">Stateless components</h2>
<p><code>live_component/3</code> calls three things:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>mount(socket) <span style="color:#ff79c6">-&gt;</span> update(assigns, socket) <span style="color:#ff79c6">-&gt;</span> render(assigns)
</span></span></code></pre></div><ul>
<li><code>mount/1</code> sets the initial state</li>
<li><code>update/2</code> sets all of the assigns given to <code>live_component/3</code>. If <code>c:update/2</code> is not defined, all assigns are simply merged into the socket</li>
<li><code>render/1</code> renders all assigns</li>
</ul>
<p>A stateless component is always mounted, updated, and rendered whenever the parent template changes.</p>
<h2 id="stateful-components-viaid">Stateful Components via<code>:id</code></h2>
<p>Components become stateful by passing an <code>:id</code> assign.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">HeroComponent</span>, <span style="color:#f1fa8c">id</span>: <span style="color:#f1fa8c">:hero</span>, <span style="color:#f1fa8c">content</span>: <span style="color:#50fa7b">@content</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>They are identified by the component module and their ID. Therefore, two different component modules with the same ID are different components. This means we can often tie the component ID to some application based ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">UserComponent</span>, <span style="color:#f1fa8c">id</span>: <span style="color:#50fa7b">@user</span><span style="color:#ff79c6">.</span>id, <span style="color:#f1fa8c">user</span>: <span style="color:#50fa7b">@user</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>The given <code>:id</code> is not necessarily used as the DOM ID. If you want to set a DOM ID, it is your responsibility to set it when rendering:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">UserComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">use</span> <span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;div id=&#34;user-&lt;%= @id %&gt;&#34; class=&#34;user&#34;&gt;&lt;%= @user.name %&gt;&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><p>Stateful components should only a single root element in the HTML template.</p>
<p>In stateful components, <code>c:mount/1</code> is called only once when it is first rendered. For each rendering, the optional   <code>c:preload/1</code> and <code>c:update/2</code> callbacks are called before <code>c:render/1</code>.</p>
<p>So on first render, the following callbacks will be invoked:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>preload(list_of_assigns) <span style="color:#ff79c6">-&gt;</span> mount(socket) <span style="color:#ff79c6">-&gt;</span> update(assigns, socket) <span style="color:#ff79c6">-&gt;</span> render(assigns)
</span></span></code></pre></div><p>On subsequent renders, these callbacks will be invoked:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>preload(list_of_assigns) <span style="color:#ff79c6">-&gt;</span> update(assigns, socket) <span style="color:#ff79c6">-&gt;</span> render(assigns)
</span></span></code></pre></div><h3 id="component-events">Component Events</h3>
<p>For a client event to reach a component, the tag must have <code>phx-target</code>. Use <code>@myself</code> to send it to the component assign.<!--  which is an *internal unique reference* to the
component instance: --></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">&#34;</span> phx<span style="color:#ff79c6">-</span>click<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;say_hello&#34;</span> phx<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;&lt;%= @myself %&gt;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">Say</span> hello!
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p><code>@myself</code> is not set for stateless components. To target another component, pass an ID or a class selector to any element inside the targeted component. Only the diff of the component is sent to the client, making them extremely efficient.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">&#34;</span> phx<span style="color:#ff79c6">-</span>click<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;say_hello&#34;</span> phx<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">user-13&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">Say</span> hello!
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Any valid query selector for <code>phx-target</code> is supported, provided that the matched nodes are children of a LiveView or LiveComponent, for example to send the <code>close</code> event to multiple components:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>a href<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">&#34;</span> phx<span style="color:#ff79c6">-</span>click<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;close&#34;</span> phx<span style="color:#ff79c6">-</span>target<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">modal, </span>#<span style="color:#f1fa8c">sidebar&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">Dismiss</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>a<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><!-- ### Preloading and update

Every time a stateful component is rendered, both `preload/1` and `update/2` are called. 

```elixir
<%= live_component UserComponent, id: user_id %>
```

A possible implementation would be to load the user on the `c:update/2`
callback:

    def update(assigns, socket) do
      user = Repo.get! User, assigns.id
      {:ok, assign(socket, :user, user)}
    end

However, the issue with said approach is that, if you are rendering
multiple user components in the same page, you have a N+1 query problem.
The `c:preload/1` callback helps address this problem as it is invoked
with a list of assigns for all components of the same type. For example,
instead of implementing `c:update/2` as above, one could implement:

    def preload(list_of_assigns) do
      list_of_ids = Enum.map(list_of_assigns, & &1.id)

      users =
        from(u in User, where: u.id in ^list_of_ids, select: {u.id, u})
        |> Repo.all()
        |> Map.new()

      Enum.map(list_of_assigns, fn assigns ->
        Map.put(assigns, :user, users[assigns.id])
      end)
    end

Now only a single query to the database will be made. In fact, the
preloading algorithm is a breadth-first tree traversal, which means
that even for nested components, the amount of queries are kept to
a minimum.

Finally, note that `c:preload/1` must return an updated `list_of_assigns`,
keeping the assigns in the same order as they were given.
-->
<h2 id="managing-state">Managing state</h2>
<p>The parent LiveView and its LiveComponent should not work on 2 different copies of the state. Only one is the truth.</p>
<p>In this scenario, each LiveView Card has a form to update the card title directly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">use</span> <span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;form phx-submit=&#34;...&#34; phx-target=&#34;&lt;%= @myself %&gt;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &lt;input name=&#34;title&#34;&gt;&lt;%= @card.title %&gt;&lt;/input&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    ...
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;/form&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">...
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><h3 id="liveview-as-the-source-of-truth">LiveView as the source of truth</h3>
<p>The board LiveView will fetch all the cards in a board, calling <code>live_component/3</code> for each card, passing the card struct as argument to <code>CardComponent</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">for</span> card <span style="color:#ff79c6">&lt;-</span> <span style="color:#50fa7b">@cards</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">card</span>: card, <span style="color:#f1fa8c">id</span>: card<span style="color:#ff79c6">.</span>id, <span style="color:#f1fa8c">board_id</span>: <span style="color:#50fa7b">@id</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>When the user submits the form, <code>CardComponent.handle_event/3</code> the Component sends an internal message to its parent Liveview via <code>self()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> handle_event(<span style="color:#f1fa8c">&#34;update_title&#34;</span>, %{<span style="color:#f1fa8c">&#34;title&#34;</span> <span style="color:#ff79c6">=&gt;</span> title}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  send self(), {<span style="color:#f1fa8c">:updated_card</span>, %{socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>card <span style="color:#ff79c6">|</span> <span style="color:#f1fa8c">title</span>: title}}
</span></span><span style="display:flex;"><span>  {<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p>The LiveView receives this event using <code>Phoenix.LiveView.handle_info/2</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">BoardView</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> handle_info({<span style="color:#f1fa8c">:updated_card</span>, card}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6272a4"># update the list of cards in the socket</span>
</span></span><span style="display:flex;"><span>  {<span style="color:#f1fa8c">:noreply</span>, updated_socket}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p>The parent LiveView will be re-rendered, sending the updated card to the Component, or by broadcasting via <code>Phoenix.PubSub</code>. This needs the LiveView to subscribe to the <code>board:&lt;ID&gt;</code> topic</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">CardComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> handle_event(<span style="color:#f1fa8c">&#34;update_title&#34;</span>, %{<span style="color:#f1fa8c">&#34;title&#34;</span> <span style="color:#ff79c6">=&gt;</span> title}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  message <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">:updated_card</span>, %{socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>card <span style="color:#ff79c6">|</span> <span style="color:#f1fa8c">title</span>: title}}
</span></span><span style="display:flex;"><span>  <span style="color:#50fa7b">Phoenix.PubSub</span><span style="color:#ff79c6">.</span>broadcast(<span style="color:#50fa7b">MyApp.PubSub</span>, board_topic(socket), message)
</span></span><span style="display:flex;"><span>  {<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defp</span> board_topic(socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;board:&#34;</span> <span style="color:#ff79c6">&lt;&gt;</span> socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>board_id
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><h3 id="livecomponent-as-the-source-of-truth">LiveComponent as the source of truth</h3>
<p>The board LiveView no longer fetches the card structs from the database. Instead, it only fetches the card ids, then render each component by passing an ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">for</span> card_id <span style="color:#ff79c6">&lt;-</span> <span style="color:#50fa7b">@card_ids</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">id</span>: card_id, <span style="color:#f1fa8c">board_id</span>: <span style="color:#50fa7b">@id</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Each CardComponent will load its own card. You should use <code>preload/1</code></p>
<p>To broadcast changes on a card, the parent LiveView must receive those events and redirect them to the appropriate card.</p>
<!--   For example, assuming card updates are sent
to the "board:ID" topic, and that the board LiveView is subscribed to
said topic, one could do: -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> handle_info({<span style="color:#f1fa8c">:updated_card</span>, card}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>send_update <span style="color:#50fa7b">CardComponent</span>, <span style="color:#f1fa8c">id</span>: card<span style="color:#ff79c6">.</span>id, <span style="color:#f1fa8c">board_id</span>: socket<span style="color:#ff79c6">.</span>assigns<span style="color:#ff79c6">.</span>id
</span></span><span style="display:flex;"><span>{<span style="color:#f1fa8c">:noreply</span>, socket}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p><code>Phoenix.LiveView.send_update/3</code> invokes the <code>CardComponent</code> given by <code>id</code>. This triggers preload and update callbacks.</p>
<h2 id="livecomponent-blocks-1">LiveComponent blocks</h2>
<p><code>do/end</code> block is possible with <code>live_component/3</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">GridComponent</span>, <span style="color:#f1fa8c">entries</span>: <span style="color:#50fa7b">@entries</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#50fa7b">New</span> <span style="color:#f1fa8c">entry</span>: <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> <span style="color:#50fa7b">@entry</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>The <code>do/end</code> will be available in an assign named <code>@inner_block</code>. You can render its contents by calling <code>render_block</code> with the assign itself and a keyword list of assigns to inject into the rendered   content. For example, the grid component above could be implemented as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">GridComponent</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">use</span> <span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;div class=&#34;grid&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &lt;%= for entry &lt;- @entries do %&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      &lt;div class=&#34;column&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        &lt;%= render_block(@inner_block, entry: entry) %&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &lt;% end %&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><p>Where the <code>:entry</code> assign was injected into the <code>do/end</code> block.</p>
<p>The <code>@inner_block</code> assign is also passed to <code>c:update/2</code> along all other assigns. So if you have a custom <code>update/2</code> implementation, make sure to assign it to the socket like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> update(%{<span style="color:#f1fa8c">inner_block</span>: inner_block}, socket) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>{<span style="color:#f1fa8c">:ok</span>, assign(socket, <span style="color:#f1fa8c">inner_block</span>: inner_block)}
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><p>The above approach is the preferred one when passing blocks to <code>do/end</code>. However, if you are outside of a .leex template and you want to invoke a component passing a <code>do/end</code> block, you will have to explicitly handle the assigns by giving it a <code>-&gt;</code> clause:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>live_component <span style="color:#50fa7b">GridComponent</span>, <span style="color:#f1fa8c">entries</span>: <span style="color:#50fa7b">@entries</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  new_assigns <span style="color:#ff79c6">-&gt;</span> <span style="color:#f1fa8c">&#34;New entry: &#34;</span> <span style="color:#ff79c6">&lt;&gt;</span> new_assigns[<span style="color:#f1fa8c">:entry</span>]
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">end</span>
</span></span></code></pre></div><h2 id="live-patches-and-live-redirects">Live patches and live redirects</h2>
<p>A template rendered inside a component can use:</p>
<ul>
<li><code>Phoenix.LiveView.Helpers.live_patch/2</code> : this is always handled by the parent<code>LiveView</code>, as components do not provide <code>handle_params</code></li>
<li><code>Phoenix.LiveView.Helpers.live_redirect/2</code></li>
</ul>
<h2 id="cost-of-stateful-components">Cost of stateful components</h2>
<h3 id="keep-only-the-assigns-necessary-in-each-component">Keep only the assigns necessary in each component.</h3>
<p>Avoid passing all of LiveView&rsquo;s assigns when rendering a component:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">MyComponent</span>, assigns %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>Instead pass only the keys that you need:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">MyComponent</span>, <span style="color:#f1fa8c">user</span>: <span style="color:#50fa7b">@user</span>, <span style="color:#f1fa8c">org</span>: <span style="color:#50fa7b">@org</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>The view and the component will share the same copies of the <code>@user</code> and <code>@org</code> assigns.</p>
<h3 id="avoid-using-stateful-components-to-provide-abstract-dom-components">Avoid using stateful components to provide abstract DOM components</h3>
<p>A good LiveComponent encapsulates application concerns and not DOM functionality. If your page shows products, you can encapsulate those products in a component. This component may have many buttons and events inside.</p>
<p>Do not write a component that is simply encapsulating generic DOM components:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">defmodule</span> <span style="color:#50fa7b">MyButton</span> <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">use</span> <span style="color:#50fa7b">Phoenix.LiveComponent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#8be9fd;font-style:italic">def</span> render(assigns) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>    ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &lt;button class=&#34;css-framework-class&#34; phx-click=&#34;click&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      &lt;%= @text %&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    &lt;/button&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  def handle_event(&#34;click&#34;, _, socket) do
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    _ = socket.assigns.on_click.()
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    {:noreply, socket}
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  end
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><p>Instead, create a function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">def</span> my_button(text, click) <span style="color:#ff79c6">do</span>
</span></span><span style="display:flex;"><span>  assigns <span style="color:#ff79c6">=</span> %{<span style="color:#f1fa8c">text</span>: text, <span style="color:#f1fa8c">click</span>: click}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ~<span style="color:#50fa7b">L</span>\<span style="color:#f1fa8c">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;button class=&#34;css-framework-class&#34; phx-click=&#34;&lt;%= @click %&gt;&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">      &lt;%= @text %&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  &lt;/button&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">  \&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">end
</span></span></span></code></pre></div><h2 id="limitations">Limitations</h2>
<ol>
<li>Components require at least one HTML tag</li>
</ol>
<p>Components must only contain HTML tags at their root. At least one HTML tag must be present. It is not possible to have components that render
only text or text mixed with tags at the root.</p>
<ol start="2">
<li>Components must always be change tracked</li>
</ol>
<p>If you render a component inside <code>form_for</code> the component ends up enclosed by the form markup, where LiveView
cannot track it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> form_for <span style="color:#50fa7b">@changeset</span>, <span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">&#34;</span>, <span style="color:#ff79c6">fn</span> f <span style="color:#ff79c6">-&gt;</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">SomeComponent</span>, <span style="color:#f1fa8c">f</span>: f %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>This causes an error:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span>    <span style="color:#ff79c6">**</span> (<span style="color:#50fa7b">ArgumentError</span>) cannot convert component <span style="color:#50fa7b">SomeComponent</span> to <span style="color:#50fa7b">HTML</span><span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">A</span> component must always be returned directly as part of a <span style="color:#50fa7b">LiveView</span> template
</span></span></code></pre></div><p>Solve this without anonymous functions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> f <span style="color:#ff79c6">=</span> form_for <span style="color:#50fa7b">@changeset</span>, <span style="color:#f1fa8c">&#34;</span>#<span style="color:#f1fa8c">&#34;</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">SomeComponent</span>, <span style="color:#f1fa8c">f</span>: f %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/</span>form<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>This issue can also happen with other helpers, such as <code>content_tag</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> content_tag <span style="color:#f1fa8c">:div</span> <span style="color:#ff79c6">do</span> %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">&lt;</span>%<span style="color:#ff79c6">=</span> live_component <span style="color:#50fa7b">SomeComponent</span>, <span style="color:#f1fa8c">f</span>: f %<span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;</span>% <span style="color:#ff79c6">end</span> %<span style="color:#ff79c6">&gt;</span>
</span></span></code></pre></div><p>So do not use <code>content_tag</code>. Instead, use LiveEEx to build the markup.</p>
<h2 id="form-bindings">Form Bindings</h2>
<p>These are in forms that intercept JS events.</p>
<p><code>Phoenix.LiveView.Socket</code> is a server-side struct that has all the data. It has an <code>assigns</code> key for current data.</p>
<p>The template exposes the data of the Socket to the browser.</p>
<p>Data is set to the Socket with <code>Phoenix.Component.assign/2</code> and <code>Phoenix.Component.assign/3</code></p>
<p>The browser accesses the Socket data in 2 ways:</p>
<ul>
<li>With LiveView as <code>socket.assigns.name_of_assign_data</code></li>
<li>With Heex as <code>@name_of_assign_data</code></li>
</ul>
<!--   ### SVG support

Since SVG allows `<svg>` tags to be nested, you can wrap the component content into an `<svg>` tag. This will ensure that it is correctly interpreted by the browser.

```elixir
defmodule CID do

  defstruct [:cid]

  defimpl Phoenix.HTML.Safe do
    def to_iodata(%{cid: cid}), do: Integer.to_string(cid)
  end

  defimpl String.Chars do
    def to_string(%{cid: cid}), do: Integer.to_string(cid)
  end
end

alias Phoenix.LiveView.Socket

defmacro __using__(_) do
  quote do
    import Phoenix.LiveView
    import Phoenix.LiveView.Helpers
    @behaviour Phoenix.LiveComponent

    require Phoenix.LiveView.Renderer
    @before_compile Phoenix.LiveView.Renderer

    @doc false
    def __live__, do: %{kind: :component, module: __MODULE__}
  end
end

@callback mount(socket :: Socket.t()) ::
            {:ok, Socket.t()} | {:ok, Socket.t(), keyword()}

@callback preload(list_of_assigns :: [Socket.assigns()]) ::
            list_of_assigns :: [Socket.assigns()]

@callback update(assigns :: Socket.assigns(), socket :: Socket.t()) ::
            {:ok, Socket.t()}

@callback render(assigns :: Socket.assigns()) :: Phoenix.LiveView.Rendered.t()

@callback handle_event(
            event :: binary,
            unsigned_params :: Phoenix.LiveView.unsigned_params(),
            socket :: Socket.t()
          ) ::
            {:noreply, Socket.t()} | {:reply, map, Socket.t()}

@optional_callbacks mount: 1, preload: 1, update: 2, handle_event: 3
end
``` -->
      
    </div>

  </article>

  <div class="container">

    <div class="px-6 mx-4">
      <div class="flex flex-wrap justify-between my-2">
        
          <div class="button border rounded-lg p-2 dark:bg-secondary-100 dark:hover:bg-neutral-700 dark:hover:text-gray-700 hover:bg-gray-100" >
            <a href="//localhost:1313/docs/tech/phoenix/liveview/bindings/" title="">
              <small class="break-words">Bindings and Streams</small>
              <svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon mr-2" fill='gray'><path d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"/></svg>
            </a>
          </div>
        


        
          <div class="button border rounded-lg p-2 dark:bg-secondary-100 dark:hover:bg-neutral-700 dark:hover:text-gray-700 hover:bg-gray-100">
            <a href="//localhost:1313/docs/tech/phoenix/liveview/handlers/" class="button" style="right: 0px; float: right ">
              <small class="break-words">Handlers</small>
              <svg height="20" width="20" class="" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="icon ml-2" fill='gray'><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
              
            </a>
          </div>
        
      </div>
    </div>
<div class="px-4 mb-2">
  
  <script src="https://giscus.app/client.js"
    data-repo="jundalisay/superblist"
    data-repo-id=""
    data-category="General"
    data-category-id=""
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
  
</div>
</div>




<div class="bg-blue-100 dark:bg-gray-900" style="background-color: teal;">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
      <div class="text-2xl font-bold text-white mb-2">Follow Us！ &rarr;</div>
      <p class="opacity-80 text-white">We&#39;re creating a new Economic System from a new Economic Science! Please support us by leaving your email or leaving a comment above.</p>



  <div>
    <form class="">
      <div class="">

      </div>
    </form>    


  <form class="w-full max-w-sm" id="email" action="https://hub.pantrypoints.com/api/email" method="post" target="_blank">  
    <div class="flex items-center flex-wrap py-2">
      <input class="bg-transparent border-b w-full text-white mr-3 p-2 m-2 leading-tight focus:outline-none" name="email[email]" required type="text" placeholder="My email" aria-label="Email">

      <input name="email[address]" id="source" type="hidden" value="//localhost:1313/docs/tech/phoenix/liveview/components/" class="p-2">                             
 
      <div id="example-container" class="p-2 cf-turnstile" data-sitekey="0x4AAAAAAACSZuKkFhl_KkiU" data-callback="javascriptCallback"></div>
      <div class="p-2 checkbox mb-3"></div>           

      <button class="w-full text-sm text-black border-4 text-white m-2 rounded" form="email" type="submit" value="Submit">
        Leave your email 
      </button>

  
    </div>
  </form>

<script type="text/javascript">
  window.onloadTurnstileCallback = function () {
    turnstile.render('#example-container', {
        sitekey: '0x4AAAAAAACSZuKkFhl_KkiU',
        callback: function(token) {
            console.log(`Challenge Success ${token}`);
        },
    });
};

</script>


    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2 pt-4">
      

      
      <li class="">
        <a href="https://twitter.com/pantrypoints"
          target="_blank"
          rel="noopener"
          aria-label="Twitter"
          class="text-gray-300 hover:text-white hover:border-gray-100 dark:text-gray-300 dark:hover:border-gray-100 dark:hover:text-white p-1 inline-block rounded-full border border-transparent cursor-pointer transition-colors">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"
            />
          </svg>
        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a
          href="https://www.youtube.com/@pantrypoints"
          target="_blank"
          rel="noopener"
          aria-label="YouTube"
          class="text-gray-300 hover:text-white hover:border-gray-100 dark:text-gray-300 dark:hover:border-gray-100 dark:hover:text-white p-1 inline-block rounded-full border border-transparent cursor-pointer transition-colors"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-brand-youtube"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <circle cx="12" cy="12" r="9" />
            <path d="M10 9l5 3l-5 3z" />
          </svg>
        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a
          href="https://www.facebook.com/pantrypoints/"
          target="_blank"
          rel="noopener"
          aria-label="Facebook"
          class="text-gray-300 hover:text-white hover:border-gray-100 dark:text-gray-300 dark:hover:border-gray-100 dark:hover:text-white p-1 inline-block rounded-full border border-transparent cursor-pointer transition-colors"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-facebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3"></path>
          </svg>
        </a>
      </li>
      

      

      
    </ul>
  </div>
  </div>
</div>




    </main>



<footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright © 2024 | <a href='/company/'>Pantrypoints Technologies</a> | Based on <a href='https://www.superphysics.org'>Superphysics</a>
    
  </span>

  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer" style="position: fixed; right: 100px; bottom: 20px">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12" />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="//localhost:1313/js/scripts.min.js"></script>




<script>
  const languageMenuButton = document.querySelector('.language-switcher');
  const languageDropdown = document.querySelector('.language-dropdown');
  languageMenuButton.addEventListener('click', (evt) => {
    evt.preventDefault()
    if (languageDropdown.classList.contains('hidden')) {
      languageDropdown.classList.remove('hidden')
      languageDropdown.classList.add('flex')
    } else {
      languageDropdown.classList.add('hidden');
      languageDropdown.classList.remove('flex');
    }
  })
</script>



<script>
  
  const darkmode = document.querySelector('.toggle-dark-mode');
  function toggleDarkMode() {
    if (document.documentElement.classList.contains('dark')) {
      document.documentElement.classList.remove('dark')
      localStorage.setItem('darkmode', 'light')
    } else {
      document.documentElement.classList.add('dark')
      localStorage.setItem('darkmode', 'dark')
    }
  }
  if (darkmode) {
    darkmode.addEventListener('click', toggleDarkMode);
  }

  const darkStorage = localStorage.getItem('darkmode');
  const isBrowserDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

  if (!darkStorage && isBrowserDark) {
    document.documentElement.classList.add('dark');
  }

  if (darkStorage && darkStorage === 'dark') {
    toggleDarkMode();
  }
</script>


<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>

  </body>

<script type="text/javascript">  
  !function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sal=t():e.sal=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);n(1);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i="Sal was not initialised! Probably it is used in SSR.",a="Your browser does not support IntersectionObserver!\nGet a polyfill from here:\nhttps://github.com/w3c/IntersectionObserver/tree/master/polyfill",s={rootMargin:"0% 50%",threshold:.5,animateClassName:"sal-animate",disabledClassName:"sal-disabled",enterEventName:"sal:in",exitEventName:"sal:out",selector:"[data-sal]",once:!0,disabled:!1},l=[],c=null,u=function(e){e&&e!==s&&(s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},s,{},e))},f=function(e){e.classList.remove(s.animateClassName)},d=function(e,t){var n=new CustomEvent(e,{bubbles:!0,detail:t});t.target.dispatchEvent(n)},b=function(){document.body.classList.add(s.disabledClassName)},p=function(){c.disconnect(),c=null},m=function(){return s.disabled||"function"==typeof s.disabled&&s.disabled()},y=function(e,t){e.forEach((function(e){e.intersectionRatio>=s.threshold?(!function(e){e.target.classList.add(s.animateClassName),d(s.enterEventName,e)}(e),s.once&&t.unobserve(e.target)):s.once||function(e){f(e.target),d(s.exitEventName,e)}(e)}))},v=function(){b(),p()},O=function(){document.body.classList.remove(s.disabledClassName),c=new IntersectionObserver(y,{rootMargin:s.rootMargin,threshold:s.threshold}),(l=[].filter.call(document.querySelectorAll(s.selector),(function(e){return!function(e){return e.classList.contains(s.animateClassName)}(e,s.animateClassName)}))).forEach((function(e){return c.observe(e)}))},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(),Array.from(document.querySelectorAll(s.selector)).forEach(f),u(e),O()};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;if(u(e),"undefined"==typeof window)return console.warn(i),{elements:l,disable:v,enable:O,reset:g};if(!window.IntersectionObserver)throw b(),Error(a);return m()?b():O(),{elements:l,disable:v,enable:O,reset:g}}},function(e,t,n){}]).default}));
  

  sal({
    threshold: 1,
    
  });
</script>    




<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/5c74f373a726ff2eea5975b7/default';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>



</html>
